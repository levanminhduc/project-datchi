{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Execution Plan Schema",
  "type": "object",
  "required": ["objective", "phases", "verification"],
  "properties": {
    "objective": {
      "type": "string",
      "description": "High-level goal description"
    },
    "phases": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["phase", "name", "parallel", "tasks"],
        "properties": {
          "phase": {
            "type": "integer",
            "minimum": 1,
            "description": "Phase number (1-indexed)"
          },
          "name": {
            "type": "string",
            "description": "Descriptive name for the phase"
          },
          "parallel": {
            "type": "boolean",
            "description": "Whether tasks in this phase can run in parallel"
          },
          "depends_on": {
            "type": "array",
            "items": { "type": "integer" },
            "description": "Array of phase numbers this phase depends on"
          },
          "tasks": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["id", "description", "agent_type", "prompt", "expected_output"],
              "properties": {
                "id": {
                  "type": "string",
                  "pattern": "^[a-z][a-z0-9_]*$",
                  "description": "Unique identifier (snake_case)"
                },
                "description": {
                  "type": "string",
                  "description": "Brief description of task purpose"
                },
                "agent_type": {
                  "type": "string",
                  "enum": [
                    "research",
                    "deep-research",
                    "explore",
                    "implement",
                    "review",
                    "test-runner",
                    "docs-expert",
                    "debugger",
                    "security-auditor"
                  ],
                  "description": "Type of agent to execute this task"
                },
                "prompt": {
                  "type": "string",
                  "description": "Detailed instructions for the agent"
                },
                "inputs": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Array of task IDs whose outputs this task needs"
                },
                "expected_output": {
                  "type": "string",
                  "description": "What the agent should return"
                }
              }
            }
          }
        }
      }
    },
    "verification": {
      "type": "object",
      "required": ["steps", "success_criteria"],
      "properties": {
        "steps": {
          "type": "array",
          "items": { "type": "string" },
          "description": "How to verify the plan was executed correctly"
        },
        "success_criteria": {
          "type": "array",
          "items": { "type": "string" },
          "description": "What defines success"
        }
      }
    }
  }
}
