## 1. Backend: Extend thread-type-supplier API and types

- [x] 1.1 Update `GET /api/thread-type-suppliers` Supabase select to include `color_id` and nested `color_data` in the `thread_type` join: change `thread_type:thread_types(id, code, name, material, tex_number)` to `thread_type:thread_types(id, code, name, material, tex_number, color_id, color_data:colors(id, name, hex_code))` — apply this in ALL select queries in `server/routes/thread-type-supplier.ts` (GET list, GET by id, POST, PATCH, GET by-thread)
- [x] 1.2 Update backend type `ThreadTypeSummary` in `server/types/thread-type-supplier.ts` to include `color_id: number | null` and `color_data?: { id: number; name: string; hex_code: string } | null`
- [x] 1.3 Update frontend type `ThreadTypeSummary` in `src/types/thread/thread-type-supplier.ts` to include `tex_number: number | null`, `color_id: number | null`, and `color_data?: { id: number; name: string; hex_code: string } | null` ← (verify: all select queries in server/routes/thread-type-supplier.ts updated, both frontend and backend TS types match API response shape, no TS errors)

## 2. Frontend: Manual Stock Entry Dialog in inventory page

- [x] 2.1 Add "Nhập Thủ Công" `q-btn` to inventory page toolbar in `src/pages/thread/inventory.vue` — place alongside existing "Nhập Kho" and "Quét tra cứu" q-btn buttons, with icon `edit_note`. Gate visibility by checking user has `thread.batch.receive` permission via `useAuth().hasPermission()`.
- [x] 2.2 Add `FormDialog` with dialog state (`showManualEntryDialog`) and form reactive data: `manualEntryForm` (supplier_id, tex_number, thread_type_id, warehouse_id, qty_full_cones, qty_partial_cones), loading/submitting states
- [x] 2.3 Implement supplier `AppSelect` — fetch from `supplierService.getAll()` on dialog open, populate AppSelect with supplier list
- [x] 2.4 Implement tex number `AppSelect` — when supplier changes, call `threadTypeSupplierService.getAll({ supplier_id })` to get thread types, extract distinct `tex_number` values, populate AppSelect. Reset tex and color on supplier change. When supplier has no thread types, show empty-state hint "NCC này chưa có loại chỉ nào" and disable Tex/Color selects.
- [x] 2.5 Implement color `AppSelect` — when tex_number changes, filter thread types matching selected tex_number, show colors from `thread_type.color_data` with hex color dot indicator (inline style). On color select, set the resolved `thread_type_id`. When no colors exist, disable the select.
- [x] 2.6 Implement warehouse `AppSelect` — fetch from `warehouseService.getStorageOnly()` to show only STORAGE-type warehouses
- [x] 2.7 Implement quantity `AppInput` type="number" fields — "Cuộn nguyên" (required, min 0) and "Cuộn lẻ" (optional, default 0). Validate at least one > 0 before submit.
- [x] 2.8 Implement submit handler — call `stockService.addStock({ thread_type_id, warehouse_id, qty_full_cones, qty_partial_cones, received_date: new Date().toISOString().split('T')[0] })`, show success snackbar via `useSnackbar()`, close dialog, reset form. On error, show error snackbar and keep dialog open. Handle potential 403 from missing permissions with Vietnamese error message. ← (verify: full cascading flow works end-to-end — NCC→Tex→Color→submit upserts into thread_stock correctly, dialog resets on close, validation prevents empty submit, only STORAGE warehouses shown, button hidden for unauthorized users)
